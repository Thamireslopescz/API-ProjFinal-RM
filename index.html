<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/assets/favicon.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <title>API RICK AND MORTY</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <div class="logo">
        <a href="https://rickandmortyapi.com/"><img src="./assets/logo.png" alt="Logo"></a>
    </div>
</header>

<h1>API de Rick and Morty</h1>

<div class="search">
    <input type="text" id="searchInput" placeholder="Digite sua pesquisa...">
    <button onclick="searchCharacters()"><i class="bi bi-search"></i></button>
</div>

<div class="card-container" id="cardContainer"></div>

<div class="image-before-footer">
    <img src="./assets/rick-and-morty-portal-shoes-white-clothing-zavvi-23.png" alt="Imagem RM">
</div>

<footer class="footer">
    <ul>
        <li>
            <span id="characterCount">PERSONAGENS: XXX</span>
        </li>
        <li>
            <span id="locationCount">LOCALIZAÇÕES: XXX</span>
        </li>
        <li>
            <span id="episodeCount">EPISÓDIOS: XXX</span>
        </li>
    </ul>
    <span class="estilo"> DESENVOLVIDO POR <a href="https://github.com/Thamireslopescz">THAMIRES LOPES</a> EM 2023</span>
</footer>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    // Função para buscar personagens
    function searchCharacters() {
        const searchInput = document.getElementById('searchInput').value;
        const apiUrl = `https://rickandmortyapi.com/api/character?name=${searchInput}`;

        axios.get(apiUrl)
            .then(function (response) {
                const characters = response.data.results;
                displayCharacters(characters);
                updateCounts(response.data.info);
            })
            .catch(function (error) {
                console.log(error);
            });
    }

    // Função para exibir os personagens na página
    function displayCharacters(characters) {
        const cardContainer = document.getElementById('cardContainer');
        cardContainer.innerHTML = '';

        characters.forEach(function (character) {
            const card = document.createElement('article');
            card.classList.add('card');

            const image = document.createElement('img');
            image.src = character.image;
            image.alt = character.name;
            card.appendChild(image);

            const cardText = document.createElement('div');
            cardText.classList.add('card-text');

            const name = document.createElement('h2');
            name.textContent = character.name;
            cardText.appendChild(name);

            const status = document.createElement('h4');
            status.innerHTML = `<span class="circle ${getStatusColor(character.status)}"></span>${character.status} - ${character.species}`;
            cardText.appendChild(status);

            const lastLocationLabel = document.createElement('p');
            lastLocationLabel.textContent = 'Última localização conhecida:';
            cardText.appendChild(lastLocationLabel);

            const lastLocation = document.createElement('p');
            lastLocation.textContent = character.location.name;
            cardText.appendChild(lastLocation);

            const lastSeenLabel = document.createElement('p');
            lastSeenLabel.textContent = 'Visto a última vez em:';
            cardText.appendChild(lastSeenLabel);

            const lastSeen = document.createElement('p');
            lastSeen.textContent = character.episode[character.episode.length - 1];
            cardText.appendChild(lastSeen);

            card.appendChild(cardText);
            cardContainer.appendChild(card);
        });
    }

    // Função para atualizar as contagens na página
    function updateCounts(info) {
        document.getElementById('characterCount').textContent = `PERSONAGENS: ${info.count}`;
        document.getElementById('locationCount').textContent = `LOCALIZAÇÕES: ${info.locations}`;
        document.getElementById('episodeCount').textContent = `EPISÓDIOS: ${info.episodes}`;
    }

    // Função auxiliar para obter a cor do status
    function getStatusColor(status) {
        switch (status) {
            case 'Alive':
                return 'green';
            case 'Dead':
                return 'red';
            default:
                return 'gray';
        }
    }
</script>

</body>
</html>
